---

export interface Props {
  projects: {
    name: string,
    link?: string,
    images: {
      src: string,
      alt: string
    }[]
  }[]
}

const { projects } = Astro.props;
---

<div class='relative w-full h-full rounded-l-2xl'>
  {projects.map(project => (
    <div class='w-full h-full bg-gradient-to-r from-slate-900 via-purple-900 to-slate-900 mySlides fade rounded-l-2xl'>
      <div id='scroll-alert' class='hidden md:flex absolute -right-16 -top-20 text-2xl flex-col items-center animate-bounce opacity-60 text-white font-matterRegular'>
        <small class='text-sm '>Role para ver detalhes</small>
        <button>&#x21e9;</button>
      </div>
      <section id='scroll-projects' class='grid w-full h-full gap-1 overflow-y-scroll overflow-x-hidden pb-9 place-items-center rounded-l-2xl scrollbar-thin scrollbar-track-white/10 scrollbar-thumb-brand'>
        {project.images.map(image => (
          <img class='select-none md:min-w-[50rem] rounded-xl' src={image.src} alt={image.alt}>
        ))}
      </section>
      <div class='absolute bottom-0 w-full py-1 text-xl text-center text-white font-matterSemiBold bg-black/50 backdrop-blur-sm rounded-bl-2xl'>
        {project.name}
        {project.link ? (
          <a class='hidden absolute bottom-0 sm:flex items-center h-full gap-2 text-sm font-matterRegular right-5' href={project?.link}>
            <img class='w-5 h-5 invert' src='icons/external-link.png' alt='icone de link externo'>
            Ver projeto
          </a>
        ): ''}
      </div>
    </div>
  ))}

  <div class='w-full h-full bg-black mySlides fade rounded-l-2xl'>
    <span class='absolute text-2xl text-center text-white top-1/2 left-10 font-matterSemiBold'>Em breve mais...</span>
  </div>

  <div class='text-2xl font-bold text-white select-none'>
    <button id='prev' class='hover:bg-black/80 w-min absolute top-1/2 xl:-left-20 cursor-pointer mt-[-22px] p-4 transition duration-500 ease-in'>&#10094;</button>
    <button id='next' class='hover:bg-black/80 w-min absolute top-1/2 right-0 xl:-right-20 cursor-pointer mt-[-22px] p-4 transition duration-500 ease-in'>&#10095;</button>
  </div>
</div>

<style>
  .fade {
    animation-name: fade;
    animation-duration: 1.5s;
  }

  @keyframes fade {
    from {opacity: .4}
    to {opacity: 1}
  }
</style>

<script>
  (document.getElementById('prev') as HTMLButtonElement).addEventListener('click', () => plusSlides(-1));
  (document.getElementById('next') as HTMLButtonElement).addEventListener('click', () => plusSlides(1));

  let slideIndex = 1;
  showSlides(slideIndex);

  function plusSlides(n: number) {
    showSlides(slideIndex += n);
  }

  function showSlides(n: number) {
    let i;
    let slides = document.getElementsByClassName('mySlides');
    if (n > slides.length) {slideIndex = 1}
    if (n < 1) {slideIndex = slides.length}
    for (i = 0; i < slides.length; i++) {
      (slides[i] as HTMLElement).style.display = 'none';
    }
    (slides[slideIndex-1] as HTMLElement).style.display = 'block';
  }
</script>